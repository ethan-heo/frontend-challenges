import"./modulepreload-polyfill-B5Qt9EMX.js";const s=document.querySelector(".register-form");if(!s)throw new Error("Form not found");const i={REQUIRED:"required",INVALID_EMAIL:"invalid-email",INVALID_AVATAR_IMG_TYPE:"invalid-avatar-img-type",INVALID_AVATAR_SIZE:"invalid-avatar-size"},g={name:{required:!0},email:{required:!0,validate:e=>/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/g.test(e)?null:i.INVALID_EMAIL},avatar:{required:!0,validate:e=>{const{type:n,size:r}=e,t=["image/png","image/jpg","image/jpeg"],a=5*1024*100;return console.log(e),t.includes(n)?r>a?i.INVALID_AVATAR_SIZE:null:i.INVALID_AVATAR_IMG_TYPE}},"github-username":{required:!0}},A=e=>(n,r)=>{const t=g[r],a=l=>l instanceof File?!l.name:!l;if(!t)throw new Error(`Validation rule not found for ${r}`);if(t.required&&a(n)){e[r]=i.REQUIRED;return}if(!t.validate)return;const d=t.validate(n);d&&(e[r]=d)},_=e=>{for(const[n,r]of Object.entries(e)){const t=s.querySelector(`[name=${n}]`);if(!t)throw new Error(`Input not found for ${n}`);t.dataset.describedby=r,t.setAttribute("aria-invalid","true")}},E=()=>{s.querySelectorAll("input").forEach(n=>{n.removeAttribute("aria-invalid"),n.removeAttribute("data-describedby")})},v=e=>{const n=e.get("avatar"),r=new FileReader;r.readAsDataURL(n),r.onload=()=>{const t={name:e.get("name"),email:e.get("email"),avatar:r.result,githubUsername:e.get("github-username")};localStorage.setItem("user-info",JSON.stringify(t))}},I=e=>{e.preventDefault();const n=e.target,r=new FormData(n),t={};r.forEach(A(t));const a=Object.entries(t).length>0;if(E(),a){_(t);return}v(r),location.href="/frontend-challenges/projects/conference-ticket-generator/ticket.html"};s.addEventListener("submit",I);const o=document.getElementById("avatar");if(!o)throw new Error("Avatar element not found");const c=document.querySelector(".register-form__avatar__upload__icon img");if(!c)throw new Error("Image element not found");const[u,m]=[".register-form__avatar__upload__btn--remove",".register-form__avatar__upload__btn--change"].map(e=>document.querySelector(e));if(!u||!m)throw new Error("Button element not found");const f={UPLOADED:"uploaded"},L=c.src;o.addEventListener("change",e=>{const n=e.target,[r]=n.files??[];if(r){const t=new FileReader;t.readAsDataURL(r),t.onload=()=>{c.src=t.result,n.dataset[f.UPLOADED]="true"}}});u.addEventListener("click",()=>{o.value="",o.dataset[f.UPLOADED]="false",c.src=L});m.addEventListener("click",()=>{o.click()});
